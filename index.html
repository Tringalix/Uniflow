<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UniFlow â€“ Il tuo flow universitario</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">

  <style>
    /* LOGIN POPUP (MODAL C) */
    .uf-login-overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #111;
      padding: 30px;
      border-radius: 14px;
      width: 320px;
      z-index: 999999;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease;
      box-shadow: 0 0 40px rgba(0,0,0,0.6);
    }

    .uf-visible {
      opacity: 1 !important;
      pointer-events: auto !important;
    }

    .uf-hidden {
      opacity: 0 !important;
      pointer-events: none !important;
    }

    .uf-login-box input {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: none;
      background: #222;
      color: white;
    }

    .uf-login-switch a {
      color: #8ab4ff;
      cursor: pointer;
    }

    /* RIASSUNTI AI */
    .uf-textarea {
      width: 100%;
      height: 180px;
      padding: 15px;
      border-radius: 12px;
      background: #111;
      color: white;
      border: 1px solid #333;
      resize: vertical;
      font-size: 15px;
    }

    .uf-summary-output h3 {
      margin-top: 20px;
    }

    .uf-summary-output ul {
      padding-left: 20px;
      margin-top: 10px;
    }

    /* TOAST */
    #uf-toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #222;
      padding: 10px 20px;
      border-radius: 20px;
      opacity: 0;
      transition: .2s;
      z-index: 1000000;
      color: white;
    }

    #uf-toast.visible {
      opacity: 1;
    }

    /* DISABILITA TOOL SE NON LOGGATO */
    .uf-disabled {
      opacity: 0.4;
      pointer-events: none;
    }
  </style>
</head>

<body class="theme-dark">

  <!-- LOGIN POPUP -->
  <div id="uf-login-screen" class="uf-login-overlay uf-visible">
    <div class="uf-login-box">
      <h2>Accedi a UniFlow</h2>
      <input type="email" id="login-email" placeholder="Email">
      <input type="password" id="login-password" placeholder="Password">
      <button class="btn-primary" onclick="uf_login()">Accedi</button>
      <p class="uf-login-switch">
        Non hai un account?
        <a onclick="uf_showRegister()">Registrati</a>
      </p>
    </div>
  </div>

  <!-- REGISTER POPUP -->
  <div id="uf-register-screen" class="uf-login-overlay uf-hidden">
    <div class="uf-login-box">
      <h2>Crea un account</h2>
      <input type="email" id="register-email" placeholder="Email">
      <input type="password" id="register-password" placeholder="Password">
      <button class="btn-primary" onclick="uf_register()">Registrati</button>
      <p class="uf-login-switch">
        Hai giÃ  un account?
        <a onclick="uf_showLogin()">Accedi</a>
      </p>
    </div>
  </div>

  <!-- HEADER -->
  <header class="uf-header">
    <div class="uf-container uf-header-inner">
      <div class="uf-logo">
        <span class="uf-logo-gradient">UniFlow</span>
      </div>

      <nav class="uf-nav">
        <a href="#tools">Tool</a>
        <a href="#media">Media</a>
        <a href="#laurea">Laurea</a>
        <a href="#planner">Obiettivi</a>
        <a href="#riassunti">Riassunti AI</a>
        <a href="#premium">Premium</a>
      </nav>

      <div class="uf-header-actions">
        <button class="btn-mini" onclick="toggleFocus()">Focus</button>
        <button class="btn-mini" onclick="toggleSidebar()">Stats</button>
        <button class="btn-mini" onclick="toggleTheme()">Tema</button>
        <button class="btn-mini" onclick="uf_logout()">Logout</button>
      </div>
    </div>
  </header>

<!-- END BLOCCO 1 -->
    <!-- HERO -->
  <section id="hero" class="uf-hero">
    <div class="uf-container uf-hero-grid">
      <div class="uf-hero-text">
        <h1>Lâ€™universitÃ , ma con piÃ¹ flow.</h1>
        <p>Organizzati meglio, studia piÃ¹ smart e sopravvivi alla sessione con stile.</p>

        <div class="uf-hero-cta">
          <a href="#tools" class="btn-primary">Scopri i tool</a>
          <a href="#media" class="btn-ghost">Calcola la tua media</a>
        </div>

        <div class="uf-countdown">
          <span>Sessione estiva tra:</span>
          <strong id="session-countdown">â€”</strong>
        </div>

        <p id="xp-label" class="uf-xp-label">+0 oggi Â· Inizia a farmare ðŸ‘€</p>
      </div>

      <div class="uf-hero-visual">
        <div class="uf-card uf-card-glow">
          <h3>UniFlow Stats</h3>
          <p>Livello <span id="uf-level">1</span> Â· XP <span id="uf-xp-total">0</span></p>
        </div>
      </div>
    </div>
  </section>

  <!-- TOOL GRID -->
  <section id="tools" class="uf-section uf-disabled">
    <div class="uf-container">
      <div class="uf-section-head">
        <h2>Tool UniFlow</h2>
      </div>

      <div class="uf-grid uf-grid-3">

        <div class="uf-tool-card">
          <h3>Calcolatore Media</h3>
          <p>Media ponderata in tempo reale.</p>
          <a href="#media" class="btn-mini">Apri</a>
        </div>

        <div class="uf-tool-card">
          <h3>Voto di laurea</h3>
          <p>Simula il voto finale.</p>
          <a href="#laurea" class="btn-mini">Apri</a>
        </div>

        <div class="uf-tool-card">
          <h3>Obiettivi</h3>
          <p>Media target e simulazioni.</p>
          <a href="#planner" class="btn-mini">Apri</a>
        </div>

        <div class="uf-tool-card">
          <h3>Riassunti AI</h3>
          <p>Incolla il testo e ottieni un riassunto perfetto.</p>
          <a href="#riassunti" class="btn-mini">Apri</a>
        </div>

      </div>
    </div>
  </section>

  <!-- CALCOLATORE MEDIA -->
  <section id="media" class="uf-section uf-disabled">
    <div class="uf-container">
      <div class="uf-section-head">
        <h2>Calcolatore Media</h2>
      </div>

      <div class="uf-media-box">
        <div class="uf-media-topbar">
          <button class="btn-mini">Simulazione</button>
          <button class="btn-mini">Importa CSV</button>
          <button class="btn-mini">Backup</button>
          <button class="btn-mini">PDF</button>
        </div>

        <div id="exam-list" class="uf-exam-list"></div>

        <button class="btn-primary uf-add-exam">+ Aggiungi esame</button>

        <div class="uf-media-actions">
          <button class="btn-mini">Ordina per voto</button>
          <button class="btn-mini">Ordina per CFU</button>
          <button class="btn-mini">Reset</button>
        </div>

        <div class="uf-media-result">
          <h3>Media</h3>
          <p id="media-value">â€”</p>

          <h3>Media in 110</h3>
          <p id="media-110">â€”</p>
        </div>

        <div class="uf-media-progress">
          <h3>Progressione</h3>
          <div id="media-history" class="uf-media-history"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- LAUREA -->
  <section id="laurea" class="uf-section uf-disabled">
    <div class="uf-container">
      <div class="uf-section-head">
        <h2>Simulatore Laurea</h2>
      </div>

      <div class="uf-media-box uf-laurea-box">
        <div class="uf-laurea-grid">
          <div>
            <label>Media in 110</label>
            <input type="number" id="laurea-media110">
          </div>
          <div>
            <label>Bonus</label>
            <input type="number" id="laurea-bonus">
          </div>
          <div>
            <label>Tesi</label>
            <input type="number" id="laurea-tesi">
          </div>
          <div>
            <label>Arrotondamento</label>
            <select id="laurea-round">
              <option value="none">Nessuno</option>
              <option value="floor">Per difetto</option>
              <option value="ceil">Per eccesso</option>
              <option value="nearest">Vicino</option>
            </select>
          </div>
        </div>

        <button class="btn-primary">Calcola</button>

        <div class="uf-media-result">
          <h3>Voto stimato</h3>
          <p id="laurea-result">â€”</p>
        </div>
      </div>
    </div>
  </section>

  <!-- PLANNER -->
  <section id="planner" class="uf-section uf-disabled">
    <div class="uf-container">
      <div class="uf-section-head">
        <h2>Obiettivi & Simulazioni</h2>
      </div>

      <div class="uf-media-box uf-planner-box">
        <div class="uf-laurea-grid">
          <div>
            <label>Media attuale (110)</label>
            <input type="number" id="planner-current110">
          </div>
          <div>
            <label>CFU fatti</label>
            <input type="number" id="planner-cfu-done">
          </div>
          <div>
            <label>CFU mancanti</label>
            <input type="number" id="planner-cfu-left">
          </div>
          <div>
            <label>Obiettivo (110)</label>
            <input type="number" id="planner-target110">
          </div>
        </div>

        <button class="btn-primary">Calcola</button>

        <div class="uf-media-result">
          <h3>Media necessaria</h3>
          <p id="planner-result">â€”</p>
        </div>
      </div>
    </div>
  </section>

  <!-- RIASSUNTI AI -->
  <section id="riassunti" class="uf-section uf-disabled">
    <div class="uf-container">
      <div class="uf-section-head">
        <h2>Riassunti AI</h2>
        <p>Incolla il testo e lascia che UniFlow lo sintetizzi per te.</p>
      </div>

      <div class="uf-media-box uf-summary-box">
        <textarea id="summary-input" class="uf-textarea" placeholder="Incolla qui il testo da riassumere..."></textarea>

        <button class="btn-primary" onclick="uf_generateSummary()">Genera Riassunto</button>

        <div id="summary-output" class="uf-summary-output uf-hidden">
          <h3>Riassunto breve</h3>
          <p id="summary-short">â€”</p>

          <h3>Riassunto esteso</h3>
          <p id="summary-long">â€”</p>

          <h3>Punti chiave</h3>
          <ul id="summary-points"></ul>

          <h3>Domande per ripassare</h3>
          <ul id="summary-questions"></ul>
        </div>
      </div>
    </div>
  </section>

<!-- END BLOCCO 2 -->
    <!-- SIDEBAR -->
  <div id="uf-sidebar" class="uf-sidebar">
    <div class="uf-sidebar-inner">
      <h3>Statistiche</h3>
      <p>Livello: <span id="uf-side-level">1</span></p>
      <p>XP: <span id="uf-side-xp">0</span></p>
      <p>Media: <span id="uf-side-media">â€”</span></p>
      <p>Media 110: <span id="uf-side-media110">â€”</span></p>
      <p>Esami: <span id="uf-side-exams">0</span></p>

      <h4>Obiettivi</h4>
      <ul id="uf-goals"></ul>

      <button class="btn-mini" onclick="toggleSidebar()">Chiudi</button>
    </div>
  </div>

  <!-- TOAST -->
  <div id="uf-toast"></div>

  <!-- SCRIPT COMPLETO -->
  <script>
    /* TOAST */
    function uf_toast(msg) {
      const t = document.getElementById("uf-toast");
      t.textContent = msg;
      t.classList.add("visible");
      setTimeout(() => t.classList.remove("visible"), 2000);
    }

    /* LOGIN POPUP */
    function uf_showLogin() {
      document.getElementById("uf-login-screen").classList.add("uf-visible");
      document.getElementById("uf-login-screen").classList.remove("uf-hidden");

      document.getElementById("uf-register-screen").classList.add("uf-hidden");
      document.getElementById("uf-register-screen").classList.remove("uf-visible");
    }

    function uf_showRegister() {
      document.getElementById("uf-register-screen").classList.add("uf-visible");
      document.getElementById("uf-register-screen").classList.remove("uf-hidden");

      document.getElementById("uf-login-screen").classList.add("uf-hidden");
      document.getElementById("uf-login-screen").classList.remove("uf-visible");
    }

    /* REGISTRAZIONE */
    function uf_register() {
      const email = document.getElementById("register-email").value.trim();
      const pass  = document.getElementById("register-password").value.trim();

      if (!email || !pass) return uf_toast("Compila tutto");

      const users = JSON.parse(localStorage.getItem("users") || "{}");

      if (users[email]) return uf_toast("Email giÃ  registrata");

      users[email] = { password: pass };
      localStorage.setItem("users", JSON.stringify(users));

      uf_toast("Registrazione completata");
      uf_showLogin();
    }

    /* LOGIN */
    function uf_login() {
      const email = document.getElementById("login-email").value.trim();
      const pass  = document.getElementById("login-password").value.trim();

      const users = JSON.parse(localStorage.getItem("users") || "{}");

      if (!users[email] || users[email].password !== pass)
        return uf_toast("Credenziali errate");

      uf_toast("Login effettuato");

      document.getElementById("uf-login-screen").classList.add("uf-hidden");
      document.getElementById("uf-login-screen").classList.remove("uf-visible");

      document.getElementById("uf-register-screen").classList.add("uf-hidden");
      document.getElementById("uf-register-screen").classList.remove("uf-visible");

      uf_unlockTools();
    }

    /* LOGOUT */
    function uf_logout() {
      uf_showLogin();
      uf_lockTools();
    }

    /* BLOCCA TOOL FINCHÃ‰ NON LOGGATO */
    function uf_lockTools() {
      document.querySelectorAll(".uf-section").forEach(sec => {
        sec.classList.add("uf-disabled");
      });
    }

    /* SBLOCCA TOOL DOPO LOGIN */
    function uf_unlockTools() {
      document.querySelectorAll(".uf-section").forEach(sec => {
        sec.classList.remove("uf-disabled");
      });
    }

    /* RIASSUNTI AI (VERSIONE OFFLINE) */
    function uf_generateSummary() {
      const text = document.getElementById("summary-input").value.trim();
      if (!text) return uf_toast("Incolla un testo da riassumere");

      const short = text.length > 200 ? text.slice(0, 200) + "..." : text;
      const long  = text.length > 600 ? text.slice(0, 600) + "..." : text;

      const sentences = text.split(".").filter(s => s.trim().length > 0);
      const points = sentences.slice(0, 5);
      const questions = sentences.slice(0, 5).map(s => "Cosa significa: " + s.trim() + "?");

      document.getElementById("summary-short").textContent = short;
      document.getElementById("summary-long").textContent = long;

      const ulPoints = document.getElementById("summary-points");
      ulPoints.innerHTML = "";
      points.forEach(p => {
        const li = document.createElement("li");
        li.textContent = p.trim();
        ulPoints.appendChild(li);
      });

      const ulQ = document.getElementById("summary-questions");
      ulQ.innerHTML = "";
      questions.forEach(q => {
        const li = document.createElement("li");
        li.textContent = q;
        ulQ.appendChild(li);
      });

      document.getElementById("summary-output").classList.remove("uf-hidden");
    }

    /* BLOCCA TOOL ALL'AVVIO */
    uf_lockTools();
  </script>

</body>
</html>
